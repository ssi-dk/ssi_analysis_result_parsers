# Directive for creating a script for your notebook


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

# Libraries

Include all the libraries which should be used in this module. You can
also import modules from other notebooks; here, we have imported the
functions in the core notebook.

``` python
# This block should never be exported. It is to have python running in the project (and not the nbs) dir, and to initiate the package using pip.
os.chdir(core.PROJECT_DIR)
```

# Functions

Add your code here below. If your notebook will be used as a
console-script, you need to add a “cli”-function, at the end (see
[Coding in
NBdev](https://dksund.sharepoint.com/:fl:/g/contentstorage/CSP_7c761ee7-b577-4e08-8517-bc82392bf65e/ETlSfUyArSNJhX8veMI_JQ8By1aXGHzDJkhotpfpXx4mmw?e=037EwH&nav=cz0lMkZjb250ZW50c3RvcmFnZSUyRkNTUF83Yzc2MWVlNy1iNTc3LTRlMDgtODUxNy1iYzgyMzkyYmY2NWUmZD1iJTIxNXg1MmZIZTFDRTZGRjd5Q09TdjJYblkwVlNiWXFYcE1yaHVrVmZqTVJUVEE4X1VwZjhTd1JxcjRNdmFrSmh2RCZmPTAxVlVLVzVWSlpLSjZVWkFGTkVORVlLN1pQUERCRDZKSVAmYz0lMkYmYT1Mb29wQXBwJnA9JTQwZmx1aWR4JTJGbG9vcC1wYWdlLWNvbnRhaW5lciZ4PSU3QiUyMnclMjIlM0ElMjJUMFJUVUh4a2EzTjFibVF1YzJoaGNtVndiMmx1ZEM1amIyMThZaUUxZURVeVpraGxNVU5GTmtaR04zbERUMU4yTWxodVdUQldVMkpaY1Zod1RYSm9kV3RXWm1wTlVsUlVRVGhmVlhCbU9GTjNVbkZ5TkUxMllXdEthSFpFZkRBeFZsVkxWelZXU1RJMVJsaFBNalkyUlZkQ1FqTTFRVmhKVTBkRFVVcFdXa1klM0QlMjIlMkMlMjJpJTIyJTNBJTIyNzRmNzM1ZmUtYzg4Ny00MjhhLWFkZmYtNTEyZTg2YmNmZmQzJTIyJTdE)
(**Code execution** and **Input, output and options**) on loop for more
details)

------------------------------------------------------------------------

<a
href="https://github.com/thej-ssi/ssi_analysis_result_parsers/blob/main/ssi_analysis_result_parsers/Nmeningitidis_parser.py#L96"
target="_blank" style="float:right; font-size:smaller">source</a>

### NmeningitidisResults

>  NmeningitidisResults (results_dict)

*Initialize self. See help(type(self)) for accurate signature.*

------------------------------------------------------------------------

<a
href="https://github.com/thej-ssi/ssi_analysis_result_parsers/blob/main/ssi_analysis_result_parsers/Nmeningitidis_parser.py#L75"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_cc_from_mlst

>  extract_cc_from_mlst (MLST:str, mlst_scheme_tsv:pathlib.Path='/users/data
>                            /Projects/MICROBIAL_SURVEILLANCE/Resources/Database
>                            s/mlst/neisseria/neisseria.txt')

------------------------------------------------------------------------

<a
href="https://github.com/thej-ssi/ssi_analysis_result_parsers/blob/main/ssi_analysis_result_parsers/Nmeningitidis_parser.py#L40"
target="_blank" style="float:right; font-size:smaller">source</a>

### extract_meningotype

>  extract_meningotype (meningotype_tsv:pathlib.Path)

## TESTING

``` python
meningotype_results = extract_meningotype(meningotype_tsv=Path("test_input/Nmeningitidis/meningotype/meningotype1.tsv"))

assert(meningotype_results["SEROGROUP"] == "Y")
assert(meningotype_results["VR1"] == "21")
assert(meningotype_results["VR2"] == "16")
assert(meningotype_results["FetA"] == "F3-7")

cc_results = extract_cc_from_mlst("1157",Path("test_input/Nmeningitidis/neisseria_mlst_scheme.tsv"))
cc_results = extract_cc_from_mlst("11",Path("test_input/Nmeningitidis/neisseria_mlst_scheme.tsv"))




f = NmeningitidisResults.from_tool_paths_dict(file_paths=  {"sample_1": {"meningotype_results": "test_input/Nmeningitidis/meningotype/meningotype1.tsv", "MLST": "1466", "mlst_scheme_tsv": "test_input/Nmeningitidis/neisseria_mlst_scheme.tsv"},
                                                            "sample_2": {"meningotype_results": "test_input/Nmeningitidis/meningotype/meningotype2.tsv", "MLST": "1157", "mlst_scheme_tsv": "test_input/Nmeningitidis/neisseria_mlst_scheme.tsv"}
                                                            })

assert(f.results_df["SEROGROUP"]["sample_1"] == "Y")
assert(f.results_df["VR1"]["sample_1"] == "21")
assert(f.results_df["CC"]["sample_1"] == "174")
assert(f.results_df["SEROGROUP"]["sample_2"] == "X")
assert(f.results_df["VR2"]["sample_2"] == "2-67")
assert(f.results_df["CC"]["sample_2"] == "1157")

f = NmeningitidisResults.from_tool_paths_tsv(tool_paths_tsv=Path("test_input/Nmeningitidis/batch_parser_file_paths.tsv"))

print(f.results_df)
```

             SEROGROUP   VR1   VR2   FetA    CC
    sample_1         Y    21    16   F3-7   174
    sample_2         X     5  2-67  F5-36  1157
    sample_3         B  18-1  30-4   F3-3      
    sample_4       NaN   NaN   NaN    NaN      
    sample_5       NaN   NaN   NaN    NaN      

    No meningotype output found at test_input/Nmeningitidis/meningotype/meningotype4.tsv
    Meningotype output file empty at test_input/empty_file.txt

------------------------------------------------------------------------

<a
href="https://github.com/thej-ssi/ssi_analysis_result_parsers/blob/main/ssi_analysis_result_parsers/Nmeningitidis_parser.py#L184"
target="_blank" style="float:right; font-size:smaller">source</a>

### Nmeningitidis_batch_parser

>  Nmeningitidis_batch_parser (file_path_tsv:pathlib.Path=None,
>                                  output_file:pathlib.Path=None)

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>file_path_tsv</td>
<td>Path</td>
<td>None</td>
<td>Path to tsv containing file paths to the outputs from tools to be
parsed. Must contain headers “sample_name”, “sbt_results”, and
“lag1_blast_results”</td>
</tr>
<tr>
<td>output_file</td>
<td>Path</td>
<td>None</td>
<td>Path to output tsv</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/thej-ssi/ssi_analysis_result_parsers/blob/main/ssi_analysis_result_parsers/Nmeningitidis_parser.py#L166"
target="_blank" style="float:right; font-size:smaller">source</a>

### Nmeningitidis_parser

>  Nmeningitidis_parser (meningotype_tsv:pathlib.Path=None, MLST:str=None,
>                            mlst_scheme_tsv:pathlib.Path=None,
>                            sample_name:str=None,
>                            output_file:pathlib.Path=None)

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>meningotype_tsv</td>
<td>Path</td>
<td>None</td>
<td>Blast output from blasting EMM and emm-like genes</td>
</tr>
<tr>
<td>MLST</td>
<td>str</td>
<td>None</td>
<td>MLST to deduce Clonal complex from</td>
</tr>
<tr>
<td>mlst_scheme_tsv</td>
<td>Path</td>
<td>None</td>
<td>Path to pubmlst scheme for neisseria for MLST: CC table</td>
</tr>
<tr>
<td>sample_name</td>
<td>str</td>
<td>None</td>
<td></td>
</tr>
<tr>
<td>output_file</td>
<td>Path</td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

# Directive for ensuring that the code in your notebook get executed as a script

The code-block here below is required to ensure that the code in the
notebook is also transferred to the module (script), otherwise it will
just be a notebook. See [Coding in
NBdev](https://dksund.sharepoint.com/:fl:/g/contentstorage/CSP_7c761ee7-b577-4e08-8517-bc82392bf65e/ETlSfUyArSNJhX8veMI_JQ8By1aXGHzDJkhotpfpXx4mmw?e=037EwH&nav=cz0lMkZjb250ZW50c3RvcmFnZSUyRkNTUF83Yzc2MWVlNy1iNTc3LTRlMDgtODUxNy1iYzgyMzkyYmY2NWUmZD1iJTIxNXg1MmZIZTFDRTZGRjd5Q09TdjJYblkwVlNiWXFYcE1yaHVrVmZqTVJUVEE4X1VwZjhTd1JxcjRNdmFrSmh2RCZmPTAxVlVLVzVWSlpLSjZVWkFGTkVORVlLN1pQUERCRDZKSVAmYz0lMkYmYT1Mb29wQXBwJnA9JTQwZmx1aWR4JTJGbG9vcC1wYWdlLWNvbnRhaW5lciZ4PSU3QiUyMnclMjIlM0ElMjJUMFJUVUh4a2EzTjFibVF1YzJoaGNtVndiMmx1ZEM1amIyMThZaUUxZURVeVpraGxNVU5GTmtaR04zbERUMU4yTWxodVdUQldVMkpaY1Zod1RYSm9kV3RXWm1wTlVsUlVRVGhmVlhCbU9GTjNVbkZ5TkUxMllXdEthSFpFZkRBeFZsVkxWelZXU1RJMVJsaFBNalkyUlZkQ1FqTTFRVmhKVTBkRFVVcFdXa1klM0QlMjIlMkMlMjJpJTIyJTNBJTIyNzRmNzM1ZmUtYzg4Ny00MjhhLWFkZmYtNTEyZTg2YmNmZmQzJTIyJTdE)
(**Writing your own notebooks**) on loop for more details.
